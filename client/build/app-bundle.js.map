{"version":3,"sources":["webpack:///webpack/bootstrap 6a641e48037a6f4989ac","webpack:///./src/models/utils.js","webpack:///./src/models/businesses.js","webpack:///./src/views/business_list_view.js","webpack:///./src/views/mapWrapper.js","webpack:///./src/models/business.js","webpack:///./src/app.js","webpack:///./src/views/business_info_window.js","webpack:///./src/views/business_info_window_content.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;AChEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK,O;AACL;AACA;AACA;AACA;;AAEA,uB;;;;;;ACdA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA,2B;;;;;;;ACnCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iFAAiF,OAAO;AACxF;;AAEA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAmC;AACnC,6K;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA,sCAAsC,2DAA2D;AACjG,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iC;;;;;;ACrLA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,YAAY;AACZ,UAAU;AACV,QAAQ;;AAER;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;AACA,cAAc,wBAAwB;AACtC;AACA;AACA,GAAG;;AAEH;AACA;AACA,sBAAsB,mD;AACtB;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,4B;;;;;;AC7EA;;AAEA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,yB;;;;;;;;;;ACdA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B,iCAAiC;AAC5D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAA0B,wBAAwB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA,sDAAsD,2BAA2B;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;;;AAIA;AACA;AACA;AACA;AACA;AACA;;AAEA,0B;;;;;;;ACnFA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mC;;;;;;AChCA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qDAAqD,OAAO;AAC5D;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,mBAAmB,iBAAiB;AACpC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,qCAAqC;AACrC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,0C","file":"app-bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6a641e48037a6f4989ac","var Utils = function(){\n\n}\n\nUtils.prototype.formatDistance = function (distance) {\n    result = Math.round(distance)\n    if (result < 1000) {\n        return result + \"m\"\n    } else { \n        result /= 1000\n        return result.toFixed(1) + \"km\"\n    }\n}\n\nmodule.exports = Utils;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/models/utils.js\n// module id = 1\n// module chunks = 0","var Business = require ('./business.js')\n\nvar Businesses = function (mapWrapper) {\n    this.mapWrapper = mapWrapper \n    this.businesses = []\n    this.done = null\n}\n\nBusinesses.prototype = {\n    populate: function (latLng) {\n        var request = new XMLHttpRequest()\n\n        // new\n        request.open(\"POST\", \"http://localhost:3000/api/businesses\")\n        request.setRequestHeader(\"Content-Type\", \"application/json\")\n        request.onload = function () {\n            if (request.status !== 200) return\n            var jsonString = request.responseText\n            var yelpBusinesses = JSON.parse(jsonString).businesses\n            this.businesses = yelpBusinesses.map(function(business) {\n                return new Business(business, this.mapWrapper)\n            }.bind(this))\n            this.done(this.businesses)\n        }.bind(this)\n        var payload = JSON.stringify({\n            term: \"burrito\",\n            locale: \"en_GB\",\n            latitude: latLng.lat,\n            longitude: latLng.lng,\n            limit: 50\n        })\n        request.send(payload)\n    }\n}\n\nmodule.exports = Businesses\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/models/businesses.js\n// module id = 2\n// module chunks = 0","var Utils = require('../models/utils');\nvar utils = new Utils();\n\nvar BusinessListView = function (container, mapWrapper) {\n    this.container = container  // is the <table id=\"list\">\n    this.mapWrapper = mapWrapper\n    this.currentlySelected = null\n    this.currentSort = \"distance\"  // initial setting\n    this.currentlyOpenInfoWindow = null\n    this.currentlyOpenTextArea = null\n    this.currentLocation = null \n    this.notes = JSON.parse(localStorage.getItem(\"edinburrito\")) || {}\n}\n\nBusinessListView.prototype.highlightCurrentSort = function (sorts) {\n    for (var sort of sorts) {\n        if (sort.id === this.currentSort) {\n            if (!sort.classList.contains(\"selected-sort\")) {\n                sort.classList.add(\"selected-sort\")\n            }\n        } else {\n            if (sort.classList.contains(\"selected-sort\")) {\n                sort.classList.remove(\"selected-sort\")\n            }\n        }\n    }\n}\n    \nBusinessListView.prototype.render = function (businesses) {\n    var sorts = document.querySelectorAll(\".sort\")\n    this.highlightCurrentSort(sorts)\n\n    var blw = this\n    for (var sort of sorts) {\n        sort.addEventListener(\"click\", function () {\n            blw.currentSort = this.id\n            blw.highlightCurrentSort(sorts)\n            blw.buildTable(blw.sortedBy(businessRows, this.id))\n        })\n    }\n\n    // make an array of objects with the business details and the\n    // complete <tr> for displaying it\n    businessRows = businesses.map(function (business) {\n        return {\n            details: business.details,\n            row: this.makeTableRow(business),\n        }\n    }.bind(this))\n\n    businessRows = this.sortedBy(businessRows, this.currentSort)\n    this.buildTable(businessRows)\n}\n\nBusinessListView.prototype.buildTable = function (businessRows) {\n    var th = document.querySelector(\"th\")\n\n    while (this.container.hasChildNodes()) {\n        this.container.removeChild(this.container.lastChild)\n    }\n\n    businessRows.forEach(function (businessRow) {\n        this.container.appendChild(businessRow.row)\n    }.bind(this))\n}\n\nBusinessListView.prototype.sortedBy = function (rows, key) {\n        // returns a new array\n        switch (key) {\n            case \"name\":\n                return rows.sort(function (a, b) {\n                    if (a.details.name < b.details.name) return -1;\n                    else if (a.details.name > b.details.name) return 1;\n                    else return 0;\n                })\n                break;\n            case \"price\":\n                return rows.sort(function (a, b) {\n                    var aPrice = a.details.price || \"a long string\"\n                    var bPrice = b.details.price || \"a long string\"\n                    return aPrice.length - bPrice.length\n                })\n                break;\n            case \"rating\":\n                return rows.sort(function (a, b) {\n                    return parseFloat(b.details.rating) - parseFloat(a.details.rating)\n                })\n                break;\n            case \"distance\":\n                return rows.sort(function (a, b) {\n                    return a.details.distance - b.details.distance\n                })\n                break;\n            default:  // in case some other search key is entered\n                return rows\n        }\n    }\n\nBusinessListView.prototype.makeTableRow = function (business) {\n    var tr = document.createElement(\"tr\")\n\n    var nameTd = document.createElement(\"td\")\n    nameTd.classList.add(\"name\")\n    nameTd.innerHTML = '<p>' + business.details.name + '</p>'\n    tr.appendChild(nameTd)\n\n    var priceTd = document.createElement(\"td\")\n    priceTd.classList.add(\"price\")\n    if (business.details.price) {\n        priceTd.innerHTML = '<p class=\"boxed\">' + business.details.price + '</p>'\n    }\n    tr.appendChild(priceTd)\n\n    var ratingTd = document.createElement(\"td\")\n    ratingTd.classList.add(\"rating\")\n    ratingTd.innerHTML = '<p class=\"boxed\">' + business.details.rating + '&#8201;&#9733;</p>' // thin space + star\n    tr.appendChild(ratingTd)\n\n    var distanceTd = document.createElement(\"td\")\n    distanceTd.classList.add(\"distance\")\n    distanceTd.innerHTML = '<p>' + utils.formatDistance(business.details.distance) + '</p>'\n    tr.appendChild(distanceTd)\n\n\n\n\n    tr.onclick = function () {\n        // closing previously opened one\n        // also save the info at this point (? - there's probably a better way) USE ONBLUR!\n        if (this.currentlyOpenTextArea) {\n            this.notes[this.currentlyOpenTextArea.id] = this.currentlyOpenTextArea.textarea.value\n            localStorage.setItem(\"edinburrito\", JSON.stringify(this.notes))\n            this.currentlyOpenTextArea.row.remove()\n        }\n\n        this.select(tr, business)  \n        this.mapWrapper.googleMap.setCenter(business.coords)\n        this.mapWrapper.googleMap.setZoom(16)\n        if (this.currentLocation) { // you need to have geolocated first\n            this.mapWrapper.calculateAndDisplayRoute(this.mapWrapper.directionsService, this.mapWrapper.directionsDisplay, this.currentLocation, business.coords, 'WALKING');         \n        }\n\n        // create elements\n        var infoTr = document.createElement(\"tr\")\n\n        var infoTd = document.createElement(\"td\")\n        infoTd.setAttribute(\"colspan\", \"4\")\n        var textarea = document.createElement(\"textarea\")\n        textarea.id = \"notes\"\n\n        // add review from localStorage if there is one\n        // (set placeholder text if not)\n        if (this.notes[business.details.id]) {\n            textarea.innerText = this.notes[business.details.id]\n        } else {\n            textarea.setAttribute(\"placeholder\", \"your notes here\")\n        }\n\n        // now add the elements\n        infoTd.appendChild(textarea)\n        infoTr.appendChild(infoTd)\n        tr.parentNode.insertBefore(infoTr, tr.nextSibling) // !\n        this.currentlyOpenTextArea = { row: infoTr, textarea: textarea, id: business.details.id }  // so it can be closed later\n    }.bind(this)\n\n    if (business.details.is_closed === \"true\") {\n        tr.classList.add(\"currently-closed\")  // TODO: see why this isn't working\n    }\n    \n    return tr\n}\n\nBusinessListView.prototype.select = function (tr, business) {\n    if (this.currentlySelected) {\n        this.currentlySelected.classList.remove(\"selected\")\n    }\n    tr.classList.add(\"selected\")\n    this.currentlySelected = tr\n    this.mapWrapper.openInfoWindow(business)\n}\n\nmodule.exports = BusinessListView\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/business_list_view.js\n// module id = 4\n// module chunks = 0","var MapWrapper = function(container, coords, zoom){\n  this.currentlyOpenInfoWindow = null\n  this.markers = []\n  this.googleMap = new google.maps.Map(container, {\n    center: coords,\n    zoom: zoom\n  });\n  this.directionsDisplay = new google.maps.DirectionsRenderer;\n  this.directionsService = new google.maps.DirectionsService;\n  this.directionsDisplay.setMap(this.googleMap);\n}\n\nMapWrapper.prototype = {\n\n  calculateAndDisplayRoute: function(directionsService, directionsDisplay,origin, destination, selectedMode) {\n         directionsService.route({\n           origin: origin,\n           destination: destination,\n           travelMode: google.maps.TravelMode[selectedMode]\n         }, function(response, status) {\n           if (status == 'OK') {\n             directionsDisplay.setDirections(response);\n           } // no route will be shown if no available results (ZERO_RESULTS etc)\n         });\n       },\n\n  addMarker: function (coords) {\n    var marker = new google.maps.Marker({\n      position: coords,\n      map: this.googleMap,\n      animation: google.maps.Animation.DROP,\n      icon: '/images/burrito.png' \n    });\n    this.markers.push(marker)\n    return marker;\n  },\n\n  addMyLocationMarker: function (coords) {\n    var marker = new google.maps.Marker({\n      position: coords,\n      map: this.googleMap,\n      animation: google.maps.Animation.DROP,\n      icon: '/images/minion.png'\n    })\n    this.markers.push(marker)\n    return marker\n  },\n\n   removeMarkers: function(){\n      for(i=0; i< this.markers.length; i++){\n          this.markers[i].setMap(null);\n      }\n  },\n\n  addClickEvent: function(){\n    google.maps.event.addListener(this.googleMap, 'click', function(event){\n      var position = { lat: event.latLng.lat(), lng: event.latLng.lng() }  \n      this.addMarker(position);\n    }.bind(this));\n  },\n\n  openInfoWindow: function (business) {\n    if (this.currentlyOpenInfoWindow) this.currentlyOpenInfoWindow.close()\n    // this next line is brutal:\n    business.infoWindow.infoWindow.open(business.mapWrapper.googleMap, business.marker)\n    this.currentlyOpenInfoWindow = business.infoWindow.infoWindow\n  },\n\n    reposition: function(coords) {\n        this.removeMarkers()\n        this.googleMap.setCenter(coords);\n        this.googleMap.setZoom(16);\n        this.addMyLocationMarker(coords)\n    }\n\n}\n\nmodule.exports = MapWrapper \n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/mapWrapper.js\n// module id = 5\n// module chunks = 0","var BusinessInfoWindow = require(\"../views/business_info_window.js\")\n\nvar Business = function (details, mapWrapper) {\n    this.mapWrapper = mapWrapper\n    this.coords = { lat: details.coordinates.latitude, lng: details.coordinates.longitude }\n    this.details = details\n    this.moreDetails = null\n    this.infoWindow = new BusinessInfoWindow(this)\n    this.marker = mapWrapper.addMarker(this.coords)\n    this.marker.addListener(\"click\", function() {\n        this.infoWindow.open()\n    }.bind(this))\n}\n\nmodule.exports = Business\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/models/business.js\n// module id = 6\n// module chunks = 0","var MapWrapper = require('./views/mapWrapper.js')\nvar BusinessListView = require('./views/business_list_view.js')\nvar Businesses = require('./models/businesses.js')\nvar map\nvar marker\n\nvar initialize = function () {\n    var mapDiv = document.querySelector(\"#map\")\n    var defaultLocation = { lat: 55.953291, lng: -3.200000 } // Edinburgh (George St)\n    var mainMap = new MapWrapper(mapDiv, defaultLocation, 15)\n    var body = document.querySelector(\"body\")\n    var calculateAndDisplayRoute = document.querySelector('#floating-panel')\n    \n    var showCredits = function () {\n        flexContainer.style.opacity = 0.3\n        creditsPopup.style.display = \"block\"\n        credits.onclick = hideCredits\n        body.onmouseup = hideCredits // a click anywhere will hide the popup\n    }\n\n    var hideCredits = function () {\n        flexContainer.style.opacity = 1\n        creditsPopup.style.display = \"none\"\n        credits.onclick = showCredits\n        body.onmouseup = null\n    }\n\n    var flexContainer = document.querySelector(\"#flex-container\")\n    var creditsPopup = document.querySelector(\"#credits-popup\")\n    creditsPopup.onclick = hideCredits\n    var credits = document.querySelector(\"#credits-text\")\n    credits.onclick = showCredits\n\n    var search = document.querySelector('#location')\n    search.onkeydown = function (e) {\n        if (e.keyCode === 13) {        // 13 = Enter\n            searchAddress(this.value)\n        }\n    }\n\n    function redraw(coords) {\n        businessListView.currentLocation = coords\n        mainMap.reposition(coords)\n        businesses.populate(coords)\n    }\n\n    function searchAddress(searchString) {\n        var geocoder = new google.maps.Geocoder()\n        geocoder.geocode({ address: searchString }, function (results, status) {\n            if (status == google.maps.GeocoderStatus.OK) {\n                var coords = {\n                    lat: results[0].geometry.location.lat(),\n                    lng: results[0].geometry.location.lng()\n                }\n                redraw(coords)\n            }\n        })\n    }\n\n    var whereAmI = document.querySelector('#my-location')\n    var van = document.querySelector(\"#van\")\n    // must reset the animation once it's completed, otherwise cannot be retriggered\n    van.addEventListener(\"animationend\", function () { van.style.animation = \"\" })\n    whereAmI.onclick = function () {\n        van.style.animation = \"van-progress 5s ease-in 0s 1\"\n        navigator.geolocation.getCurrentPosition(function (position) {\n            var coords = {\n                lat: position.coords.latitude,\n                lng: position.coords.longitude\n            }\n            redraw(coords)\n        })\n    }\n\n\n\n    var businesses = new Businesses(mainMap)    // getting the burrito data\n    var list = document.querySelector(\"#business-list\")  // setup views\n    var businessListView = new BusinessListView(list, mainMap)\n    businesses.done = businessListView.render.bind(businessListView)  //set callback for request\n    businesses.populate(defaultLocation)        // get data from server\n}\n\nwindow.onload = initialize\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app.js\n// module id = 11\n// module chunks = 0","var BusinessInfoWindowContent = require(\"./business_info_window_content.js\")\n\nvar BusinessInfoWindow = function (business) {\n    this.business = business\n    this.content = new BusinessInfoWindowContent(this.business)\n    this.infoWindow = new google.maps.InfoWindow()\n    this.infoWindow.setContent(this.content.createContentDiv())\n}\n\n// just a wrapper so we can say business.infoWindow.open()\n// rather than business.infoWindow.infoWindow.open(args)\n// it passes through to mapWrapper, which does the actual opening\n// since the mapWrapper also handles closing any previously opened InfoWindows\nBusinessInfoWindow.prototype.open = function () {\n    this.business.mapWrapper.openInfoWindow(this.business)\n    this.getMoreDetails(this.content.expandContent.bind(this.content))  // !\n}\n\nBusinessInfoWindow.prototype.getMoreDetails = function (callback) {\n    if (!this.moreDetails){\n        var request = new XMLHttpRequest();\n        request.open(\"GET\", \"http://localhost:3000/api/businesses/\"+ this.business.details.id);\n        request.onload = function(){\n            if ( request.status !== 200 ) return \n                var jsonString = request.responseText\n                var moreDetails = JSON.parse(jsonString)\n                callback(moreDetails)\n        }\n        request.send()\n    }\n}\n\nmodule.exports = BusinessInfoWindow\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/business_info_window.js\n// module id = 13\n// module chunks = 0","var Utils = require('../models/utils')\nvar utils = new Utils()\n\nvar BusinessInfoWindowContent = function (business) {\n    this.business = business\n    this.details = business.details\n    this.div = document.createElement('div')\n}\n\nBusinessInfoWindowContent.prototype.createContentDiv = function () {\n    // var div = document.createElement('div')\n    this.div.classList.add('info-window')\n\n    var name = document.createElement('p')\n    name.classList.add('name') \n    name.classList.add('underline')\n    name.innerText = this.details.name\n    this.div.appendChild(name)\n\n    var address = document.createElement('p')\n    address.innerText = this.details.location.address1\n    this.div.appendChild(address)\n\n    if (this.details.image_url) {\n        var imageDiv = document.createElement('div')\n        imageDiv.id = \"image-div\"\n    \n        var image = document.createElement('img')\n        image.id = \"business-image\"\n        imageDiv.appendChild(image)\n        image.src = this.details.image_url\n        this.div.appendChild(imageDiv)\n    }\n\n    var detailsDiv = document.createElement('div')\n    detailsDiv.style.display = \"flex\"\n    detailsDiv.style.flexDirection = \"row\"\n    detailsDiv.style.verticalAlign = \"middle\"\n\n    if (this.details.price) {\n        var price = document.createElement('p')\n        price.innerText = this.details.price\n        price.classList.add(\"boxed\")\n        detailsDiv.appendChild(price)\n    }\n  \n    var rating = document.createElement('p')\n    rating.innerHTML = this.details.rating + \"&#8201;&#9733;\"\n    rating.classList.add(\"boxed\")\n    detailsDiv.appendChild(rating)\n\n    var distance = document.createElement('p')\n    distance.innerText = utils.formatDistance(this.details.distance)\n    detailsDiv.appendChild(distance)\n\n    this.div.appendChild(detailsDiv)\n\n    var telephone = document.createElement('p')\n    if (this.details.display_phone !== \"\" && this.details.display_phone) {\n        telephone.innerText = \"Phone: \" + this.details.display_phone\n        this.div.appendChild(telephone)\n    }\n\n    var openingHours = document.createElement('p')\n    openingHours.id = \"opening-hours\"\n    openingHours.classList.add(\"greyed-out\")\n    openingHours.innerText = 'Fetching opening hours...'\n    this.div.appendChild(openingHours)\n\n    return this.div\n} \n\nBusinessInfoWindowContent.prototype.expandContent = function (moreDetails) {\n    var openingHours = document.querySelector(\"#opening-hours\")\n    if (moreDetails.hours) {\n        openingHours.innerText = \"See opening hours...\"\n        openingHours.classList.remove(\"greyed-out\")\n        openingHours.classList.add(\"opening-hours-link\")\n        openingHours.addEventListener(\"click\", function () {\n            this.buildOpeningHoursTable(moreDetails)\n            this.div.removeChild(openingHours)\n        }.bind(this))\n    } else {\n        openingHours.innerText = \"Sorry, no opening hours available\"\n    }\n}\n\nBusinessInfoWindowContent.prototype.buildOpeningHoursTable = function (moreDetails) {\n    var open = document.createElement('p')\n    if (moreDetails.hours[\"0\"].is_open_now) {\n        open.innerText = \"currently open\"\n        open.classList.add(\"currently-open\")\n    } else {\n        open.innerText = \"currently closed\"\n        open.classList.add(\"currently-closed\")\n    }\n    this.div.appendChild(open)\n\n    var daysMap = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"]\n\n    var table = document.createElement('table')\n    table.id = \"opening-hours-table\"\n\n    var days = moreDetails.hours[\"0\"].open \n        for (i = 0; i < days.length; i++) {\n            var tr = document.createElement('tr')\n            tr.classList.add('openingHoursTableRows')\n\n            var dayTd = document.createElement('td')\n            dayTd.innerText = daysMap[days[i].day]\n            dayTd.classList.add(\"day-column\")\n            tr.appendChild(dayTd)\n\n            var startTd = document.createElement('td')\n            startTd.innerText = days[i].start\n            tr.appendChild(startTd)\n\n            var toTd = document.createElement('td')\n            toTd.innerHTML = \"&ndash;\"\n            tr.appendChild(toTd)\n\n            var endTd = document.createElement('td')\n            endTd.innerText = days[i].end\n            tr.appendChild(endTd)\n        \n            table.appendChild(tr)\n        }\n        this.div.appendChild(table)\n}\n\nmodule.exports = BusinessInfoWindowContent\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/business_info_window_content.js\n// module id = 14\n// module chunks = 0"],"sourceRoot":""}